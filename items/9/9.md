# 9. 단위 테스트

- 애자일과 TDD 덕택에 단위 테스트를 자동화하는 프로그래머들이 많아 졌으며 점점 더 늘어나는 추세다.
- 하지만 제대로 된 테스트 케이스를 작성해야 한다는 좀 더 미묘한(그리고 더 중요한) 사실을 놓쳐버렸다

<br />

### TDD 법칙 세가지

#### ■ 첫째 법칙:

- 실패하는 단위 테스트를 작성할 때 까지 실제 코드를 작성하지 않는다

#### ■ 둘째 법칙

- 컴파일은 실패하지 않으면서 실행이 실해하는 정도로만 단위 테스트를 작성한다

#### ■ 셋째 법칙

- 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다

<br />

위 세 가지 규칙을 따르면 개발과 테스트가 대략 30초 정도로 묶인다. 테스트 코드가 실제 코드가 함께 나올뿐더러 테스트 코드가 실제 코드보다 불과 몇 초 전에 나온다.

이렇게 일하면 실제 코드를 사실상 전부 테스트하는 테스트 케이스가 나온다. 하지만 실제 코드와 맞먹을 정도로 방대한 테스트 코드는 심각한 관리 문제를 유발하기도 한다.

<br />

### 깨끗한 테스트 코드 유지하기

- 실제 코드가 진화하면 테스트 코드도 변해야 한다
  - 그래서 테스트 코드도 깨끗한 코드로 유지하는 게 좋다.
- 테스트 코드는 실제 코드 못지 않게 중요하다

#### ■ 테스트는 유연성, 유지보수성, 재사용성을 제공한다

- 코드에 유연성, 유지보수성, 재사용성을 제공하는 버팀목이 바로 단위 테스트다

<br />

### 꺠끗한 테스트 코드

- 꺠끗한 테스트 코드를 만드려면 세 가지가 필요하다! 가독성, 가독성, 가독성!
  - 가독성은 실제 코드보다 테스트 코드에 더더욱 중요하다
  - 가독성을 높이려면, 명료성, 단순선, 풍부한 표현력이 필요하다
    - 테스트 코드는 최소의 표현으로 많은 것을 나타내야 한다
      - 중복을 제거하자
      - 자질구레한 사항이 많아 표현력이 떨어지지 않게 하자
      - 테스트 코드와 무관한 내용을 넣지 말자
      - 테스트 코드도 읽는 사람을 고려해서 작성하자
- 테스트 코드는 잡다하고 세세한 코드를 거의 다 없애고 작성하자
- 테스트 코드는 본론에 돌입해 진짜 필요한 자료 유형과 함수만 사용한다
- 코드가 수행하는 기능을 재빨리 이해할 수 있도록 작성하자

<br />

### 도메인에 특화된 테스트 언어

#### ■ 이중 표준

- 실제 환경과 테스트 환경은 요구사항이 판이하게 다르다
  - 실제 환경에서는 절대로 안 되지만 테스트 환경에서는 전혀 문제없는 방식이 있다
    - 대개 메모리나 CPU 효율 등

<br />

### 테스트 당 `assert` 하나

- `assert` 문이 단 하나인 함수는 결론이 하나라서 코드를 이해하기 쉽고 빠르다

#### ■ 테스트 당 개념 하나

> 테스트 함수마다 한 개념만 테스트하라!

<br />

### F, I, R, S, T

- 깨끗한 테스트는 다섯 가지 규칙을 따르는데, 각 규칙에서 첫 글자를 따오면 FIRST가 된다

#### ■ `Fast` 빠르게

- 테스트는 빨라야 한다
- 테스트는 빨리 돌아야 한다는 말이다. 테스느가 느리면 자주 돌릴 엄두를 못 낸다

#### ■ `Independent` 독립적으로

- 각 테스트는 서로 의존하면 안된다
- 한 테스트가 다음 테스트가 실행될 환경을 준비해서는 안 된다
- 각 테스트는 독립적으로 그리고 어떤 순서로 실행해도 괜찮아야 한다

#### ■ `Repeatable` 반복가능하게

- 테스트는 어떤 환경에서도 반복 가능해야 한다(네트워크가 연결되지 않는 환경에서도..)

#### ■ `Self-Validating` 자가검증하는

- 테스트는 불리언 값으로 결과를 내야 한다
  - 성공 아니면 실패다

#### ■ `Timely` 적시에

- 테스트는 적싱에 작성해야 한다.
- 단위 테스트는 테스트하려는 실제 코드를 구현하기 직전에 구현한다

<br />
<br />
